<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:inline="text">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="#{title}">PC Store</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/style.css}">
  <style>
    /* Chỉ để đảm bảo anchor-ảnh không đè nút */
    .prod-img { height: 200px; object-fit: cover; }
    .img-link { display:block; line-height:0; } /* không overlay */
    .product-card img { border-top-left-radius:.5rem; border-top-right-radius:.5rem; }
  </style>
</head>
<body>

<!-- Header -->
<div th:replace="~{layout/header :: header(danhMucs=${danhMucs})}"></div>

<!-- Hero Section -->
<section class="hero text-center position-relative">
  <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="6000">
    <div class="carousel-inner">
      <div class="carousel-item active" th:style="|background-image: url('@{/photos/banner1.jpg}')|">
        <div class="carousel-caption d-none d-md-block">
          <h1 class="display-3 fw-bold animated-text neon-text" th:text="#{hero.title}">Xây dựng PC mơ ước của bạn</h1>
          <p class="lead animated-text" th:text="#{hero.subtitle}">CPU, GPU, RAM, SSD chính hãng – Giá tốt, bảo hành uy tín</p>
          <a href="#products" class="btn btn-danger btn-lg mt-3 animated-button neon-border" th:text="#{hero.btn}">Mua ngay</a>
        </div>
        <div class="particle-overlay"></div>
      </div>

      <div class="carousel-item" th:style="|background-image: url('@{/photos/bannerpcstore.jpg}')|">
        <div class="carousel-caption d-none d-md-block">
          <h1 class="display-3 fw-bold animated-text neon-text" th:text="#{hero.title}">Xây dựng PC mơ ước của bạn</h1>
          <p class="lead animated-text" th:text="#{hero.subtitle}">CPU, GPU, RAM, SSD chính hãng – Giá tốt, bảo hành uy tín</p>
          <a href="#products" class="btn btn-danger btn-lg mt-3 animated-button neon-border" th:text="#{hero.btn}">Mua ngay</a>
        </div>
        <div class="particle-overlay"></div>
      </div>

      <div class="carousel-item" th:style="|background-image: url('@{/photos/banner3.jpg}')|">
        <div class="carousel-caption d-none d-md-block">
          <h1 class="display-3 fw-bold animated-text neon-text" th:text="#{hero.title}">Xây dựng PC mơ ước của bạn</h1>
          <p class="lead animated-text" th:text="#{hero.subtitle}">CPU, GPU, RAM, SSD chính hãng – Giá tốt, bảo hành uy tín</p>
          <a href="#products" class="btn btn-danger btn-lg mt-3 animated-button neon-border" th:text="#{hero.btn}">Mua ngay</a>
        </div>
        <div class="particle-overlay"></div>
      </div>

      <div class="carousel-item" th:style="|background-image: url('@{/photos/banner4.jpg}')|">
        <div class="carousel-caption d-none d-md-block">
          <h1 class="display-3 fw-bold animated-text neon-text" th:text="#{hero.title}">Xây dựng PC mơ ước của bạn</h1>
          <p class="lead animated-text" th:text="#{hero.subtitle}">CPU, GPU, RAM, SSD chính hãng – Giá tốt, bảo hành uy tín</p>
          <a href="#products" class="btn btn-danger btn-lg mt-3 animated-button neon-border" th:text="#{hero.btn}">Mua ngay</a>
        </div>
        <div class="particle-overlay"></div>
      </div>
    </div>

    <button class="carousel-control-prev custom-control" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next custom-control" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>
</section>

<!-- Product Section -->
<div class="container my-5 ">
  <h2 class="text-center mb-4 text-danger fw-bold" th:text="#{product.featured}">Sản phẩm nổi bật</h2>

  <div id="products" class="row g-4">
    <div class="col-sm-6 col-md-4 col-lg-3" th:each="p : ${products}">
      <div class="card product-card h-100">
        <!-- ẢNH CHỈ BỌC BỞI <a> TRONG KHU VỰC ẢNH, KHÔNG OVERLAY -->
        <a class="img-link" th:href="@{|/sanpham/${p.maSP}|}">
          <img th:src="@{'/photos/' + ${p.hinhAnh}}" class="card-img-top prod-img" th:alt="${p.tenSP}">
        </a>

        <div class="card-body text-center d-flex flex-column">
          <h5 class="card-title text-truncate" th:text="${p.tenSP}">Tên sản phẩm</h5>
          <p class="card-text fw-bold" th:text="${#numbers.formatDecimal(p.gia, 0, 'POINT', 0, 'COMMA')} + 'đ'">0đ</p>

          <!-- Cụm nút -->
          <div class="mt-auto w-100">
            <!-- Hàng trên: Chi tiết + Mua ngay -->
            <div class="row g-2 mb-2">
              <div class="col-6">
                <a class="btn btn-dark w-100 btn-tall text-nowrap" th:href="@{|/sanpham/${p.maSP}|}">
                  <i class="bi bi-eye me-1"></i> Chi tiết
                </a>
              </div>
              <div class="col-6">
                <button class="btn btn-danger w-100 btn-tall text-nowrap"
                        th:attr="onclick=|buyNow(${p.maSP})|">
                  <i class="bi bi-lightning-charge me-1"></i> Mua ngay
                </button>
              </div>
            </div>
            <!-- Hàng dưới: Thêm vào giỏ -->
            <button class="btn btn-outline-danger w-100 btn-tall text-nowrap"
                    th:attr="onclick=|addToCart(${p.maSP})|">
              <i class="bi bi-cart-plus me-1"></i> Thêm vào giỏ
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Cart Offcanvas (fragment dùng chung) -->
<div th:replace="~{layout/cart-offcanvas :: cart}"></div>

<!-- Footer -->
<div th:replace="~{layout/footer :: footer}"></div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/main.js}"></script>
<script th:inline="javascript">
  /*<![CDATA[*/
  /*<![CDATA[*/ window.USER_ID = /*[[${session.userId}]]*/ 3; /*]]>*/
  // addToCart(productId) đã có trong main.js, ở đây chỉ gọi đúng chữ ký cũ
  /*]]>*/
</script>
</body>
</html>

