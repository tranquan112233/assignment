<!-- √î t√¨m ki·∫øm -->
<form class="d-flex mb-3" th:action="@{/admin/products}" method="get">
    <input type="text" name="keyword" class="form-control me-2 w-25"
           placeholder="T√¨m s·∫£n ph·∫©m..." th:value="${keyword}">
    <button type="submit" class="btn btn-primary me-2">
        <i class="bi bi-search"></i> T√¨m
    </button>
</form>

<!-- B·∫£ng danh s√°ch s·∫£n ph·∫©m -->
<div class="table-responsive shadow-sm rounded-3">
    <table class="table table-hover table-striped align-middle text-center mb-0">
        <thead class="table-secondary">
        <tr>
            <th scope="col"><i class="bi bi-hash"></i></th>
            <th scope="col"><i class="bi bi-box-seam"></i> T√™n s·∫£n ph·∫©m</th>
            <th scope="col"><i class="bi bi-cash-stack"></i> Gi√°</th>
            <th scope="col"><i class="bi bi-123"></i> S·ªë l∆∞·ª£ng</th>
            <th scope="col"><i class="bi bi-tags"></i> Danh m·ª•c</th>
            <th scope="col"><i class="bi bi-truck"></i> Nh√† cung c·∫•p</th>
            <th scope="col"><i class="bi bi-gear"></i> Thao t√°c</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="p, st : ${products}">
            <td th:text="${st.index + 1 + currentPage * 10}"></td>
            <td th:text="${p.name}"></td>
            <td th:text="${#numbers.formatDecimal(p.price, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></td>
            <td th:text="${p.quantity}"></td>
            <td th:text="${p.category.name}"></td>
            <td th:text="${p.supplier.name}"></td>
            <td class="d-flex justify-content-center gap-1">
                <!-- üîç N√∫t xem chi ti·∫øt -->
                <button type="button" class="btn btn-sm btn-primary text-white"
                        th:attr="data-bs-toggle='modal', data-bs-target='#viewModal__' + ${p.id}">
                    <i class="bi bi-eye"></i> Xem
                </button>

                <!-- ‚úèÔ∏è N√∫t s·ª≠a -->
                <a th:href="@{'/admin/products/edit/' + ${p.id}}"
                   class="btn btn-sm btn-warning text-white">
                    <i class="bi bi-pencil-square"></i> S·ª≠a
                </a>

                <!-- ‚ùå N√∫t x√≥a -->
                <button type="button" class="btn btn-sm btn-danger"
                        th:attr="data-bs-toggle='modal', data-bs-target='#deleteModal__' + ${p.id}">
                    <i class="bi bi-trash"></i> X√≥a
                </button>

                <!-- üß© Modal xem chi ti·∫øt -->
                <div class="modal fade" th:id="'viewModal__' + ${p.id}" tabindex="-1"
                     aria-labelledby="viewModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-lg">
                        <div class="modal-content border-0 shadow-lg">
                            <div class="modal-header bg-primary text-white">
                                <h5 class="modal-title">
                                    <i class="bi bi-box-seam"></i> Chi ti·∫øt s·∫£n ph·∫©m
                                </h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body text-start">
                                <div class="row">
                                    <div class="col-md-5 text-center">
                                        <img th:src="@{|/uploads/${p.image}|}" class="img-fluid rounded shadow-sm mb-2"
                                             alt="H√¨nh s·∫£n ph·∫©m" style="max-height: 250px;">
                                    </div>
                                    <div class="col-md-7">
                                        <h5 th:text="${p.name}" class="fw-bold"></h5>
                                        <p class="text-muted mb-1">
                                            <i class="bi bi-tag"></i>
                                            <span th:text="${p.category.name}"></span> |
                                            <i class="bi bi-truck"></i>
                                            <span th:text="${p.supplier.name}"></span>
                                        </p>
                                        <p>
                                            <strong>Gi√°:</strong>
                                            <span th:text="${#numbers.formatDecimal(p.price, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></span>
                                        </p>
                                        <p><strong>S·ªë l∆∞·ª£ng c√≤n:</strong> <span th:text="${p.quantity}"></span></p>
                                        <hr>
                                        <p><strong>M√¥ t·∫£:</strong></p>
                                        <p th:text="${p.description}"
                                           style="white-space: pre-line;"
                                           class="text-secondary"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- üóëÔ∏è Modal x√°c nh·∫≠n x√≥a -->
                <div class="modal fade" th:id="'deleteModal__' + ${p.id}" tabindex="-1"
                     aria-labelledby="deleteLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content border-0 shadow-lg">
                            <div class="modal-header bg-danger text-white">
                                <h5 class="modal-title">
                                    <i class="bi bi-exclamation-triangle"></i> X√°c nh·∫≠n x√≥a
                                </h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <p>B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m
                                    <strong th:text="${p.name}">T√™n s·∫£n ph·∫©m</strong>
                                    (ID: <span th:text="${p.id}"></span>) kh√¥ng?</p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                                <a th:href="@{'/admin/products/delete/' + ${p.id}}" class="btn btn-danger">
                                    <i class="bi bi-trash"></i> X√≥a
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </td>
        </tr>

        <tr th:if="${#lists.isEmpty(products)}">
            <td colspan="7" class="text-muted py-3">
                <i class="bi bi-exclamation-circle"></i> Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o.
            </td>
        </tr>
        </tbody>
    </table>
</div>

<!-- Ph√¢n trang -->
<nav th:if="${totalPages > 1}">
    <ul class="pagination justify-content-center mt-3">
        <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
            <a class="page-link"
               th:href="${keyword != null && keyword != '' ?
                  '/admin/products?page=' + (currentPage - 1) + '&keyword=' + keyword :
                  '/admin/products?page=' + (currentPage - 1)}">
                <i class="bi bi-chevron-left"></i> Tr∆∞·ªõc
            </a>
        </li>

        <li class="page-item"
            th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
            th:classappend="${i == currentPage} ? 'active'">
            <a class="page-link"
               th:text="${i + 1}"
               th:href="${keyword != null && keyword != '' ?
                  '/admin/products?page=' + i + '&keyword=' + keyword :
                  '/admin/products?page=' + i}"></a>
        </li>

        <li class="page-item" th:classappend="${currentPage + 1 >= totalPages} ? 'disabled'">
            <a class="page-link"
               th:href="${keyword != null && keyword != '' ?
                  '/admin/products?page=' + (currentPage + 1) + '&keyword=' + keyword :
                  '/admin/products?page=' + (currentPage + 1)}">
                Sau <i class="bi bi-chevron-right"></i>
            </a>
        </li>
    </ul>
</nav>
